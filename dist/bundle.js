(()=>{"use strict";(e=>{let t=document.querySelector("#timer-hours"),o=document.querySelector("#timer-minutes"),n=document.querySelector("#timer-seconds"),s=0;function a(e){return 1===String(e).length?"0"+e:String(e)}s=setInterval((function(){let e=function(){let e=(new Date(undefined).getTime()-(new Date).getTime())/1e3,t=0,o=0,n=0;return e>0&&(t=Math.floor(e%60),o=Math.floor(e/60%60),n=Math.floor(e/60/60)),{timeRemaining:e,hours:n,minutes:o,seconds:t}}();t.textContent=a(e.hours),o.textContent=a(e.minutes),n.textContent=a(e.seconds),e.timeRemaining<0&&clearInterval(s)}),1e3)})(),(()=>{const e=document.querySelector(".menu"),t=document.querySelector("menu"),o=()=>{let e=event.target;e.closest(".menu")?screen.width>768?t.classList.toggle("active-menu"):t.style.transform="translate(0)":e!==t&&e.closest('[href^="#"]')&&(screen.width>768?t.classList.toggle("active-menu"):t.style.transform="translate(-100%)")};e.addEventListener("click",o),t.addEventListener("click",o)})(),(()=>{const e=document.querySelector(".popup"),t=document.querySelectorAll(".popup-btn"),o=document.querySelector(".popup-content"),n={count:-450,speed:100,startPos:-450,endPos:0},s=()=>{(n.startPos>n.endPos?n.count-=n.speed:n.count+=n.speed)&&(o.style.transform=`translateY(${n.count}px)`),(n.startPos>n.endPos?n.count>n.endPos:n.count<n.endPos)&&requestAnimationFrame(s)};t.forEach((t=>{t.addEventListener("click",(()=>{e.style.display="block",screen.width>768&&(n.count=n.startPos,requestAnimationFrame(s))}))})),e.addEventListener("click",(t=>{let o=t.target;o.classList.contains("popup-close")?e.style.display="none":(o=o.closest(".popup-content"),null===o&&(e.style.display="none"))}))})(),(()=>{const e=document.querySelector(".service-header"),t=document.querySelectorAll(".service-header-tab"),o=document.querySelectorAll(".service-tab");e.addEventListener("click",(e=>{let n=e.target;n=n.closest(".service-header-tab"),n&&t.forEach(((e,s)=>{e===n&&(e=>{for(let n=0;n<o.length;n++)e===n?(t[n].classList.add("active"),o[n].classList.remove("d-none")):(t[n].classList.remove("active"),o[n].classList.add("d-none"))})(s)}))}))})(),(()=>{const e=document.querySelectorAll(".portfolio-item"),t=document.querySelectorAll(".dot"),o=document.querySelector(".portfolio-content");let n,s=0;const a=(e,t,o)=>{e[t].classList.remove(o)},r=(e,t,o)=>{e[t].classList.add(o)},c=()=>{a(e,s,"portfolio-item-active"),a(t,s,"dot-active"),s++,s>=e.length&&(s=0),r(e,s,"portfolio-item-active"),r(t,s,"dot-active")},l=(e=3e3)=>{n=setInterval(c,e)};o.addEventListener("click",(o=>{o.preventDefault();let n=o.target;n.matches(".portfolio-btn, .dot")&&(a(e,s,"portfolio-item-active"),a(t,s,"dot-active"),n.matches("#arrow-right")?s++:n.matches("#arrow-left")?s--:n.matches(".dot")&&t.forEach(((e,t)=>{e===n&&(s=t)})),s>=e.length&&(s=0),s<0&&(s=e.length-1),r(e,s,"portfolio-item-active"),r(t,s,"dot-active"))})),o.addEventListener("mouseover",(e=>{(e.target.matches(".portfolio-btn")||e.target.matches(".dot"))&&clearInterval(n)})),o.addEventListener("mouseout",(e=>{(e.target.matches(".portfolio-btn")||e.target.matches(".dot"))&&l()})),l(1500)})(),(()=>{const e=document.querySelectorAll(".portfolio-item"),t=document.querySelector(".portfolio-dots");e.forEach((()=>{const e=document.createElement("li");e.classList.add("dot"),t.appendChild(e)})),t.children[0].classList.add("dot-active")})(),(()=>{const e=document.querySelector("#command .row"),t=()=>{const e=event.target;if(e.classList.contains("command__photo")){const t=e.src;e.src=e.dataset.img,e.dataset.img=t}};e.addEventListener("mouseover",t),e.addEventListener("mouseout",t)})(),(()=>{const e=document.querySelectorAll(".calc-item"),t=document.querySelectorAll("input");e.forEach((e=>{e.classList.contains("calc-type")||e.addEventListener("input",(e=>{let t=e.target;e.target.value=t.value.replace(/[^\d]/g,"")}))})),t.forEach((e=>{e.addEventListener("input",(t=>{const o=t.target;let n=o.value;if("user_name"===e.name||"user_message"===e.name)o.value=o.value.replace(/[^а-яё\s-]/gi,"");else if("user_email"===e.name){const e=/([^a-z@_\-.!~*'])|((?<=^)@+)|((?<=@.*)@+)/gi;o.value=n.replace(e,"")}else if("user_phone"===e.name){const e=/([^\d()\-+])|((?<=.{35,}).)|((?<!^)\++)|((?<=^)-)|((?<=[+-])-+)|((?<=\([\d\-)(]*)\(+)|((?<=\()\)+)|((?<=\)[\d\-)(]*)\)+)|((?<=-)-+)/gi;o.value=n.replace(e,"")}})),e.addEventListener("blur",(e=>{const t=e.target;console.log("blur at:",t),(e=>{let t=e.value;if(console.log("value: ",t),console.log("elem: ",e),"user_message"===e.name)t=t.replace(/((^[\s-]+))|((?<=\s)\s+)|((?<=-)-+)|([\s-]+$)/g,""),e.value=t;else if("user_name"===e.name){let o=t.match(/[а-я]+/gi);o=o.map((e=>e.substring(0,1).toUpperCase()+e.substring(1).toLowerCase())),t=o.join(" "),e.value=t}else"user_email"===e.name?(t=t.replace(/(?<=@)@+/g,""),e.value=t):"user_phone"===e.name?(t=t.replace(/((?<=\()\({1,})|((?<=\))\){1,})|((?<=-)-{1,})|((?<=\+)\+{1,})/g,""),e.value=t):console.log("other input")})(t)}))}))})(),((e=100)=>{const t=document.querySelector(".calc-block"),o=(document.querySelector(".calc-type"),document.querySelector(".calc-square")),n=document.querySelector(".calc-day"),s=document.querySelector(".calc-count"),a=document.getElementById("total");t.addEventListener("change",(t=>{const r=t.target;(r.matches("select")||r.matches("input"))&&(()=>{let t=function(){let e=document.querySelector(".calc-type");return-1===e.selectedIndex?e.options.text:e.options[e.selectedIndex].value}(),r=+o.value,c=0,l=1,u=1;console.log(t),s.value>1&&(l+=(s.value-1)/10),n.value&&n.value<5?u*=2:n.value&&n.value<10&&(u*=1.5),t&&r&&(c=parseInt(e*t*r*l*u*100)/100),a.textContent=c})()}))})(),(()=>{const e=e=>{const t=e.target;t.matches(".form-phone")&&(t.value=t.value.replace(/[^+\d]/g,"")),"user_name"===t.name&&(t.value=t.value.replace(/[^а-яё ]/gi,"")),t.matches(".mess")&&(t.value=t.value.replace(/[^а-яё ,.]/gi,""))},t=t=>{const o=document.getElementById(t),n=document.createElement("div");n.style.cssText="font-size: 2rem;",o.addEventListener("submit",(e=>{e.preventDefault(),o.appendChild(n);const s=new FormData(o);let a={};s.forEach(((e,t)=>{a[t]=e})),n.textContent="Загрузка...",(e=>fetch("./server.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}))(Object.fromEntries(new FormData(o))).then((e=>{if(200!==e.status)throw new Error("status network ${request.status}");setTimeout((()=>{n.textContent="Спасибо, мы скоро с вами свяжемся"}),2e3),(e=>{[...document.getElementById(e).elements].filter((e=>"button"!==e.tagName.toLowerCase()&&"button"!==e.type)).forEach((e=>e.value=""))})(t)})).catch((e=>{n.textContent="Что-то пошло не так...",console.error(e)}))})),o.addEventListener("input",e)};t("form1"),t("form2"),t("form3")})()})();